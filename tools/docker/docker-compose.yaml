services:
  dev-lab:
    build: .
    container_name: dev-lab
    stdin_open: true
    tty: true
    network_mode: host
    volumes:
      - ../../:/workspace
      # Git/GitHub 인증 공유
      - ~/.gitconfig:/home/dev/.gitconfig:ro
      - ~/.config/gh:/home/dev/.config/gh:ro
      - ~/.ssh:/home/dev/.ssh:ro
      # Claude Code 설정 공유 (인증은 컨테이너 독립 관리)
      - ~/.claude/projects:/home/dev/.claude/projects        # 프로젝트 메모리
      - ~/.claude/settings.json:/home/dev/.claude/settings.json:ro  # 설정 (읽기전용)
      # tmux 설정
      - ../tmux/.tmux.conf:/home/dev/.tmux.conf:ro
      # bash aliases
      - ./.bash_aliases:/home/dev/.bash_aliases:ro
    env_file:
      - ../../.env
    working_dir: /workspace
    # tmuxinator로 세션 시작 — 호스트에서 docker exec -it dev-lab tmux attach -t lab 로 접속
    command: bash -c "/home/dev/.tmux/plugins/tpm/bin/install_plugins && TMUX_ROOT=/workspace tmuxinator start -p tools/tmux/session.docker.yml && tail -f /dev/null"
